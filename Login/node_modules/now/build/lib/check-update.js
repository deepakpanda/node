"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function checkUpdate(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=void 0,o=check(e).then(function(e){t=e,process.on("SIGINT",function(){process.stdout.write("\n"),process.exit(1)})},function(e){return console.error(e.stack)});return process.on("exit",function(e){if(t){var o=t,r=o.current,n=o.latest,a=o.at,u=(0,_ms2["default"])(Date.now()-a);console.log("> "+_chalk2["default"].white.bgRed("UPDATE NEEDED")+" "+("Current: "+r+" â€“ ")+("Latest "+_chalk2["default"].bold(n)+" (released "+u+" ago)")),console.log("> Run `npm install -g now` to update")}}),o}function check(e){var t=e.debug,o=void 0===t?!1:t;return new _promise2["default"](function(e,t){o&&console.log("> [debug] Checking for updates."),(0,_nodeFetch2["default"])("https://registry.npmjs.org/now").then(function(t){return 200!==t.status?(o&&console.log("> [debug] Update check error. NPM "+t.status+"."),void e(!1)):void t.json().then(function(t){var r=t["dist-tags"].latest,n=_package2["default"].version;r!==_package2["default"].version?(o&&console.log("> [debug] Needs update. Current "+n+", latest "+r),e({latest:r,current:n,at:new Date(t.time[r])})):(o&&console.log("> [debug] Up to date ("+_package2["default"].version+")."),e(!1))},function(){return e(!1)})},function(){return e(!1)})})}Object.defineProperty(exports,"__esModule",{value:!0});var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise);exports["default"]=checkUpdate;var _ms=require("ms"),_ms2=_interopRequireDefault(_ms),_package=require("../../package"),_package2=_interopRequireDefault(_package),_nodeFetch=require("node-fetch"),_nodeFetch2=_interopRequireDefault(_nodeFetch),_chalk=require("chalk"),_chalk2=_interopRequireDefault(_chalk);